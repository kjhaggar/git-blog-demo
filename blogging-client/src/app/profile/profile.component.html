<nav class="navbar navbar-expand-md navbar-light navbar-fixed-top" style="background-color: rgb(176, 200, 252);">
  <div class="container-fluid">
    <div  class="navbar-header">
      <a class="navbar-brand"> Blog - Demo </a>
      <a class="navbar-brand">Welcome {{getCurrentUserName | titlecase}}</a>
    </div>
    <ul class="nav navbar-nav navbar-right">
        <li>
            <a style="cursor:pointer" (click)= "DisplayPostBox()"  *ngIf = "!displayAddPost">
                <i class="fa fa-fw fa-pencil"></i>New Blog</a>
        </li>
        <li>
          <a style="cursor:pointer" (click)="clickedHome()">
              <i class="fa fa-fw fa-home"></i>Home</a>
        </li>
        <li>
            <a style="cursor:pointer" (click)="clickedMyPost()">
                <i class="fa fa-fw fa-bookmark"></i>My Blogs</a>
        </li>
        <li>
            <a style="cursor:pointer" (click)="UsersList()">
                <i class="fa fa-fw fa-users"></i><span  [ngStyle]="{'color' : getTextColor(unreadReq)}">Friends</span>
                <sup *ngIf = "unreadReq > 0" [ngStyle]="{'background-color': getBgColor(unreadReq), 'color': getTextColor(unreadReq)}">{{unreadReq}}</sup>
              </a>
        </li>
        <li>
            <a style="cursor:pointer" (click)="Notify()">
                <i class="fa fa-fw fa-bell"></i><span  [ngStyle]="{'color' : getTextColor(numberOfNotification)}">Notification</span>
                <sup *ngIf = "numberOfNotification > 0" [ngStyle]="{'background-color': getBgColor(numberOfNotification), 'color': getTextColor(numberOfNotification)}">{{numberOfNotification}}</sup>
            </a>
        </li>
        <li>
            <a [routerLink]="['/publicProfile', getCurrentUserId]" style="color:black">
              <i class="fa fa-fw fa-user"></i>My Account</a>
        </li>
        <li>
            <a style="cursor:pointer" (click)="Logout()">
                <i class="fa fa-fw fa-sign-out"></i>Logout</a>
        </li>
    </ul>
  </div>
</nav>
<!-- <div class= "container" *ngIf="hideSuccessMessage && getCurrentUserName != getTaggedByUser">
    <p class="alert alert-success col-md-offset-9" style="text-align: center">
        <strong>You have unread notification(s)</strong>
        <button type="button" class="close" (click)="hideSuccessMessage = false">
            <span aria-hidden="true">&times;</span>
        </button>
    </p>
</div> -->

<div class= "container" *ngIf="newFriendAdded">
    <p class="alert alert-success col-md-3 col-md-offset-4" style="text-align: center">
        <strong [ngClass] ="FadeOutSuccessMsg()">Friend Request accepted..!!</strong>
        <button type="button" class="close" (click)="newFriendAdded = false">
            <span aria-hidden="true">&times;</span>
        </button>
    </p>
</div>

<div class= "container" *ngIf = "displayAddPost">
    <div class= "post">
        <div class= "col-md-6 col-md-offset-3 col-sm-8 col-sm-offset-2 border border-primary rounded ">
            <button type="button" class="close" (click)="displayAddPost = false; newBlogLink = 'New Blog'; postForm.reset(); submitted = false; uploadBlogImages = false"
            tooltip="Close" placement="top" show-delay="500">
                <span aria-hidden="true">&times;</span>
            </button>
            <form [formGroup]="postForm" enctype="multipart/form-data">
                <div class="form-group" >
                    <label for="exampleInputEmail1">Title</label>
                    <input name="title" type="text" formControlName="title" class="form-control"
                    placeholder="Enter title" [ngClass]="{ 'is-invalid': submitted && f.title.errors }">
                    <div *ngIf="submitted && !!f.title.errors" class="invalid-feedback">
                        <div *ngIf="!!f.title.errors.required">No title provided</div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="exampleInputPassword1">Description</label>
                    <textarea contenteditable name="description" id = "placeholder" formControlName="description" rows="4" class="form-control"
                    placeholder="Your post..!!" [ngClass]="{ 'is-invalid': submitted && f.description.errors }"
                    [mention]="item" [mentionConfig]="{maxItems:10}" ></textarea>
                    <div *ngIf="submitted && !!f.description.errors" class="invalid-feedback">
                        <div *ngIf="!!f.description.errors.required">Enter valid information</div>
                    </div>
                </div>
                <button type="button" class="btn btn-sm btn-primary" (click) = "showGoogleMap = true">Add Location</button>
                <div *ngIf = "showGoogleMap">
                    <agm-map [latitude]="latitude" [longitude]="longitude" [zoom]="zoom">
                            <agm-marker [latitude]="latitude" [longitude]="longitude" [markerDraggable]="true" (dragEnd)="markerDragEnd($event)"></agm-marker>
                    </agm-map>
                    <h5>Current Address: {{address}}</h5>
                    <label>Enter address</label>
                    <form>
                        <input type="text" class="form-group" [(ngModel)]="searchInfo.location" name="searchInfo">
                        <button class="btn btn-sm btn-primary" (click)="searchLoc(searchInfo)">Search</button>
                    </form>
                </div>
                <button type="button" class="btn btn-sm btn-primary" (click) ="UploadBlogImages()">Upload Media</button>
                <div class="form-group" *ngIf= "uploadBlogImages">
                    <div class="col-md-9">
                        <input formControlName="image" id="image" name="image" type="file"
                        (change)="fileChangeEvent($event)" placeholder="Upload a file..." multiple/>
                    </div>
                </div>
                <button type="button" class="btn btn-sm btn-primary" (click) = "AddPost()">Post</button>
            </form>
        </div>
    </div>
</div>

<div class= "container" *ngIf = "showAllPost">
    <h2>All Blogs</h2>
    <div *ngIf="sizeOfAllPost > 0; else noAllPost">
    <div class = "displayPost panel panel-primary" *ngFor = "let post of postList">
        <form>
            <div class="panel-heading row clearfix">
                <div *ngFor = "let user of usersProfile" class="panel-title pull-left">
                    <img class = "logo" *ngIf = "post.userId==user._id" [src] = GetImageUrl(user.image)/>
                </div>
                <label class="panel-title title col-lg-2" ><em>{{ post.title | titlecase}}</em></label>
                <small class="info col-lg-5" >Posted by {{post.userName | titlecase}} on {{ post.createdAt | date:'MMM dd, yyyy'}} </small>
            </div>
            <p class = "description" cols="80" rows="4">{{post.description | slice:0:234 }}...
                <a [routerLink]="['/blog', post._id]">Show More</a>
            </p>
        </form>
    </div>
    </div>
    <ng-template #noAllPost>
        <br>
        <h6>No Blog Posted.</h6>
      </ng-template>
</div>

<div class= "container" *ngIf = "showMyPost">
    <h2>My Blogs</h2>
    <div *ngIf="sizeOfMyPost > 0 ; else noMyPOst">
    <div class = "displayPost panel panel-primary" *ngFor = "let post of displayMyPost">
        <form [formGroup]="updatePost">
            <div class="panel-heading row clearfix">
                <div *ngFor = "let user of usersProfile" class="panel-title pull-left">
                    <img class = "logo" *ngIf = "post.userId==user._id" [src] = GetImageUrl(user.image)/>
                </div>
                <label class="panel-title title col-lg-2" ><em>{{ post.title | titlecase}}</em></label>
                <small class="info col-lg-4" >Posted on {{ post.createdAt | date:'MMM dd, yyyy'}} </small>
            </div>
            <p class = "description">{{post.description | slice:0:234 }}...
                <a [routerLink]="['/myBlog', post._id]">Show More</a>
            </p>
        </form>
      </div>
    </div>
    <ng-template #noMyPOst>
      <br>
      <h6>No Blog Uploaded By You.</h6>
    </ng-template>
</div>

<div class= "container" *ngIf = "showMyFriends" style="margin: 20px">
    <form class="form-inline" name="myform">
        <span class="glyphicon glyphicon-search"></span>
        <input type="text" [(ngModel)]="searchText" name="searchfriend" placeholder="Search here..">
    </form>
    <ul>
        <div *ngIf ="searchText">
        <div *ngFor="let item of items | filter: searchText;">

            <form class="form-inline">
            <div class="row" style="cursor: pointer" tooltip="Vist Profile" placement="top" show-delay="500" [routerLink]="['/publicProfile', item._id]">
                <img class="logo" [src] = GetImageUrl(item.image) alt="Your Profile Picture" >
                <h5 style="margin-top: 35px ">{{item.firstName | titlecase}} {{item.lastName | titlecase}}</h5>
            </div>
            <div *ngFor = "let new of newFriend">
            <div *ngIf = "getCurrentUserId !== item._id">
              <p *ngIf = "!friendRequestSent[new._id]">
                  <!-- <button type="button" class="btn-primary" style='margin-left: 30px;' (click)="sendRequestButton(item._id)">
                    <i class="material-icons">person_add</i>
                  </button> -->
              </p>
              <p *ngIf = "friendRequestSent[item._id]">
                <button type="button" class="btn-primary" style='margin-left: 30px;' (click) = "CancelFriendRequest(item._id)">Friend Request Sent <br> Cancel??</button>
              </p>
                <br>
              </div>
            </div>
        </form>
        </div>
    </div>
  </ul>

    <hr>
    <div class="row">
        <div class = "col-sm-5 col-md-offset-1" *ngIf = "newFriendRequest; else noRequest">
            <h3>Friend Requests</h3>
            <div class="reqColumn" *ngFor ="let new of newFriend">
                <div class="row" *ngIf = "!acceptRequest[new._id]" style="cursor: pointer" tooltip="Vist Profile" placement="top" show-delay="500" [routerLink]="['/publicProfile', new._id]">
                  <img class="logo column" [src] = GetImageUrl(new.image) alt="Your Profile Picture" [routerLink]="['/publicProfile', new._id]" >
                  <h5 class="column" style="margin-top: 35px ">{{new.firstName | titlecase}} {{new.lastName | titlecase}}</h5>
                </div>
                <div class="row" *ngIf = "!acceptRequest[new._id]">
                    <button class="col-md-4 acceptRequest" (click) = "AcceptFriendRequest(new._id, new.userName)">Accept</button>
                    <button class="col-md-4 acceptRequest" (click)="DeleteFriendRequest(new._id)">Delete</button>
                </div>
            </div>
        </div>
        <ng-template #noRequest>No pending request.</ng-template>

        <div class = "col-sm-3 col-md-offset-6" >
                <h3>My Friends</h3>
            <div *ngFor = "let profile of friendsInfo">
                <div class="row">
                    <img class="logo" [src] = GetImageUrl(profile.image) alt="Your Profile Picture" >
                    <h5 style="margin-top: 35px ">{{profile.firstName | titlecase}} {{profile.lastName | titlecase}}</h5>
                </div>
                <button type="button" class="sendRequest"style="cursor: pointer" tooltip="Vist Profile" placement="top" show-delay="500" [routerLink]="['/publicProfile', profile._id]">Visit Profile</button>
                <br>
            </div>
        </div>
    </div>
</div>

<div *ngIf="sizeOfNotifications > 0; else noMessage" class= "container toggleNotification" [@slideInOut]="menuState">
    <div class="row newNotify" *ngFor = "let new of recentNotification">
        <div class="col-lg-2" *ngFor = "let user of usersProfile" class="panel-title pull-left">
            <img class = "notifyProfile" *ngIf = "new.taggedBy == user.userName" [src] = GetImageUrl(user.image)/>
        </div>
        <div class="col-lg-10">
            <b>{{new.taggedBy}}</b> mentioned you in a <a [routerLink]="['/blog', new.postId]"  (click) = "changeStatus(new._id)">blog</a>, created on: {{new.time| date:'MMM dd, yyyy'}}
        </div>
        <br>
    </div>
</div>
<ng-template #noMessage>
    <div class= "container toggleNotification" [@slideInOut]="menuState">
        No new notification.
    </div>
</ng-template>
