<nav class="navbar navbar-expand-md navbar-light fixed-top" >
    <div class="navbar-header navbar-text">
        <h2> Blog - Demo </h2>
        <a class="navbar-brand">Welcome {{getCurrentUserName | titlecase}}</a>
    </div>
    <div class="collapse navbar-collapse">
        <ul class="navbar-nav mr-auto navbar-right ">
            <li class="nav-item ">
                <a class="nav-link" style="cursor:pointer" (click)= "DisplayPostBox()">{{newBlogLink}}</a>
            </li>
            <li class="nav-item">
                    <a class="nav-link" style="cursor:pointer" (click)="clickedHome()">Home</a>
                </li>
            <li class="nav-item">
                <a class="nav-link" style="cursor:pointer" (click)="clickedMyPost()">My Blogs</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" style="cursor:pointer" (click)="UsersList()">Friends</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" style="cursor:pointer" (click)="Notify()">Notification
                    <sup>{{numberOfNotification}}</sup>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" routerLink="/editProfile">Edit Profile</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" style="cursor:pointer" (click)="Logout()">Logout</a>
            </li>
        </ul>
    </div>
</nav>
<!-- <div class= "container" *ngIf="hideSuccessMessage && getCurrentUserName != getTaggedByUser">
    <p class="alert alert-success col-md-offset-9" style="text-align: center">
        <strong>You have unread notification(s)</strong> 
        <button type="button" class="close" (click)="hideSuccessMessage = false">
            <span aria-hidden="true">&times;</span>
        </button>                
    </p>
</div> -->

<div class= "container" *ngIf="newFriendAdded">
    <p class="alert alert-success col-md-3 col-md-offset-4" style="text-align: center">
        <strong [ngClass] ="FadeOutSuccessMsg()">Friend Request accepted..!!</strong>
        <button type="button" class="close" (click)="newFriendAdded = false">
            <span aria-hidden="true">&times;</span>
        </button>     
    </p>     
</div>

<div class= "container" *ngIf = "displayAddPost">
    <div class= "post">
        <div class= "col-md-6 col-md-offset-3 col-sm-8 col-sm-offset-2 border border-primary rounded ">
            <button type="button" class="close" (click)="displayAddPost = false; newBlogLink = 'New Blog'; postForm.reset(); submitted = false; uploadBlogImages = false">
                <span aria-hidden="true">&times;</span>
            </button>
            <form [formGroup]="postForm" enctype="multipart/form-data">
                <div class="form-group" >
                    <label for="exampleInputEmail1">Title</label>
                    <input name="title" type="text" formControlName="title" class="form-control"
                    placeholder="Enter title" [ngClass]="{ 'is-invalid': submitted && f.title.errors }">
                    <div *ngIf="submitted && f.title.errors" class="invalid-feedback">
                        <div *ngIf="f.title.errors.required">No title provided</div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="exampleInputPassword1">Description</label>
                    <textarea name="description" formControlName="description" rows="4" class="form-control"
                    placeholder="Your post..!!" [ngClass]="{ 'is-invalid': submitted && f.description.errors }"
                    [mention]="items" [mentionConfig]="{maxItems:10, labelKey: 'tag'}" ></textarea>
                    <div *ngIf="submitted && f.description.errors" class="invalid-feedback">
                        <div *ngIf="f.description.errors.required">Enter valid information</div>
                    </div>
                </div>
                <button type="button" class="btn btn-sm btn-primary" (click) = "showGoogleMap = true">Add Location</button>
                <div *ngIf = "showGoogleMap">
                    <agm-map [latitude]="latitude" [longitude]="longitude" [zoom]="zoom">
                            <agm-marker [latitude]="latitude" [longitude]="longitude" [markerDraggable]="true" (dragEnd)="markerDragEnd($event)"></agm-marker>
                    </agm-map>
                    <h5>Current Address: {{address}}</h5>
                    <label>Enter address</label>
                    <form>
                        <input type="text" class="form-group" [(ngModel)]="searchInfo.location" name="searchInfo">
                        <button class="btn btn-sm btn-primary" (click)="searchLoc(searchInfo)">Search</button>
                    </form>
                </div>
                <button type="button" class="btn btn-sm btn-primary" (click) ="UploadBlogImages()">Upload Media</button>
                <div class="form-group" *ngIf= "uploadBlogImages">
                    <div class="col-md-9">
                        <input formControlName="image" id="image" name="image" type="file" 
                        (change)="fileChangeEvent($event)" placeholder="Upload a file..." multiple/>
                    </div>
                </div>
                <button type="button" class="btn btn-sm btn-primary" (click) = "AddPost()">Post</button>
            </form>
        </div>
    </div>
</div>

<div class= "container" *ngIf = "showAllPost">
    <h2>All Blogs</h2>
    <div class = "displayPost panel panel-primary" *ngFor = "let post of postList">
        <form>
            <div class="panel-heading row clearfix">
                <div *ngFor = "let user of usersProfile" class="panel-title pull-left">
                    <img class = "logo" *ngIf = "post.userId==user._id" [src] = GetImageUrl(user.image)/>
                </div>
                <label class="panel-title title col-lg-2" ><em>{{ post.title | titlecase}}</em></label>
                <small class="info col-lg-5" >Posted by {{post.userName | titlecase}} on {{ post.createdAt | date:'MMM dd, yyyy'}} </small>
            </div>
            <p class = "description" cols="80" rows="4">{{post.description | slice:0:234 }}...
                <a [routerLink]="['/blog', post._id]">Show More</a>
            </p>
        </form>
    </div>
</div>

<div class= "container" *ngIf = "showMyPost">
    <h2>My Blogs</h2>
    <div class = "displayPost panel panel-primary" *ngFor = "let post of displayMyPost">
        <form [formGroup]="updatePost">
            <div class="panel-heading row clearfix">
                <div *ngFor = "let user of usersProfile" class="panel-title pull-left">
                    <img class = "logo" *ngIf = "post.userId==user._id" [src] = GetImageUrl(user.image)/>
                </div>
                <label class="panel-title title col-lg-2" ><em>{{ post.title | titlecase}}</em></label>
                <small class="info col-lg-4" >Posted on {{ post.createdAt | date:'MMM dd, yyyy'}} </small>   
            </div>
            <p class = "description">{{post.description | slice:0:234 }}...
                <a [routerLink]="['/myBlog', post._id]">Show More</a>
            </p>
            <div *ngFor="let count of post.imageUrl">
                <img style="margin: 10px 175px; height: 30%; width: 30%" [src] = GetBlogImageUrl(count.filename)/>
            </div>
        </form>
    </div>
</div>

<div class= "container" *ngIf = "showMyFriends">
    <form class="form-inline">
        <span class="glyphicon glyphicon-search"></span>
        <input type="text" name="searchfriend" placeholder="Search here..">
        <button type="button" value="search">Search</button>
    </form>
    <div class="row">
        <div class = "col-md-6 col-md-offset-1" *ngIf = "newFriendRequest">
            <h3>Friend Requests</h3>
            <div class="reqColumn" *ngFor ="let new of newFriend">
                <div class="row">
                    <img class="logo column" [src] = GetImageUrl(new.image) alt="Your Profile Picture" >
                    <h5 class="column" style="margin-top: 35px ">{{new.firstName | titlecase}} {{new.lastName | titlecase}}</h5>
                </div>
                <div class="row" *ngIf = "acceptRequest[new._id]">
                    <button class="col-md-4 acceptRequest" (click) = "AcceptFriendRequest(new._id, new.userName)">Accept</button>
                    <button class="col-md-4 acceptRequest" (click)="DeleteFriendRequest(new._id)">Delete</button>
                </div>
            </div>
        </div>
        <div class = "col-md-3 col-md-offset-9"  *ngFor = "let profile of usersInfo">
            <div *ngIf= "getCurrentUserId != profile._id">
                <div class="row">
                    <img class="logo" [src] = GetImageUrl(profile.image) alt="Your Profile Picture" >
                    <h5 style="margin-top: 35px ">{{profile.firstName | titlecase}} {{profile.lastName | titlecase}}</h5>
                </div>
                <p *ngIf = "!acceptRequest[profile._id] && !friendRequestSent[profile._id] && !visitUsersProfile[profile._id]">
                    <button type="button" class="sendRequest" (click)="sendRequestButton(profile._id)">Send Request</button>
                </p>
                <p *ngIf = "friendRequestSent[profile._id] && !visitUsersProfile[profile._id]">
                    <button type="button" class="sendRequest" (click) = "CancelFriendRequest(profile._id)">Friend Request Sent <br> Cancel??</button>
                </p>
                <p *ngIf = "visitUsersProfile[profile._id]">
                    <button type="button" class="sendRequest">Visit Profile</button>
                </p>
                </div>
            <br>
        </div>
    </div>
</div>

<div class= "container toggleNotification" [@slideInOut]="menuState" [ngClass] ="FadeOutSuccessMsg()">
    <div class="row newNotify" *ngFor = "let new of recentNotification" style="cursor: pointer" [routerLink]="['/blog', new.postId]" (click) = "changeStatus(new._id)">
        <div class="col-lg-2" *ngFor = "let user of usersProfile" class="panel-title pull-left">
            <img class = "notifyProfile" *ngIf = "new.taggedBy==user.userName" [src] = GetImageUrl(user.image)/>
        </div>
        <div class="col-lg-10">
            <b>{{new.taggedBy}}</b> mentioned you in a blog, created on: {{new.time| date:'MMM dd, yyyy'}}
        </div>
        <br>
    </div>
</div>